(()=>{"use strict";class t{constructor(t,e,s){this._name=t.name,this._link=t.link,this._templateSelector=e,this._handleCardClick=s}generateCard=()=>(this._cardElement=document.querySelector(this._templateSelector).content.cloneNode(!0),this._like=this._cardElement.querySelector(".element__like-button"),this._title=this._cardElement.querySelector(".element__title"),this._mask=this._cardElement.querySelector(".element__mask"),this._trash=this._cardElement.querySelector(".element__trash"),this._fillCard(),this._setEventHandlers(),this._cardElement);_likeCard=()=>{this._like.classList.toggle("element__like-button_active")};_deleteCard=()=>{this._trash.closest(".element").remove()};_setEventHandlers=()=>{this._trash.addEventListener("click",(()=>this._deleteCard())),this._like.addEventListener("click",(()=>this._likeCard())),this._mask.addEventListener("click",(()=>this._handleCardClick(this._name,this._link)))};_fillCard=()=>{this._mask.src=this._link,this._mask.alt=this._name,this._title.textContent=this._name}}const e={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save",inactiveButtonClass:"popup__save_disabled",activeButtonClass:"popup__save_valid",inputErrorClass:"popup__input_type_error",errorClass:"error"};class s{constructor(t,e){this._form=e,this._config=t,this._buttonSave=this._form.querySelector(this._config.submitButtonSelector),this._inputList=Array.from(this._form.querySelectorAll(this._config.inputSelector))}enableValidation(){this._setEventListeners()}disableSubmitButton(){this._buttonSave.classList.remove(this._config.activeButtonClass),this._buttonSave.classList.add(this._config.inactiveButtonClass),this._buttonSave.disabled=!0}enableSubmitButton(){this._buttonSave.classList.add(this._config.activeButtonClass),this._buttonSave.classList.remove(this._config.inactiveButtonClass),this._buttonSave.disabled=!1}_showInputError(t){const e=this._form.querySelector(`.${t.id}-error`);e.classList.add(this._config.errorClass),e.textContent=t.validationMessage,t.classList.add(this._config.inputErrorClass)}_hideInputError(t){const e=this._form.querySelector(`.${t.id}-error`);e.classList.remove(this._config.errorClass),e.textContent="",t.classList.remove(this._config.inputErrorClass)}_checkInputValidity(t){t.validity.valid?this._hideInputError(t):this._showInputError(t)}_hasInvalidInput(){return this._inputList.some((t=>!t.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?this.disableSubmitButton():this.enableSubmitButton()}_setEventListeners(){this._toggleButtonState(this._inputList,this._buttonSave),this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this._checkInputValidity(t),this._toggleButtonState(this._inputList,this._buttonSave)}))}))}}const i=document.querySelector(".profile__add-button"),n=document.querySelector(".profile__edit-button"),o=document.forms.editForm,r=document.forms.addForm,l=o.elements.nameInput,a=o.elements.jobInput;class c{constructor(t){this._popup=document.querySelector(t)}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",(()=>{this._handleEscClose(window.event)}))}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",(()=>{this._handleEscClose(window.event)}))}_handleEscClose(t){"Escape"===t.key&&this.close()}_handleClose(t){t.target.classList.contains("popup_opened")&&this.close()}setEventListeners(){document.addEventListener("mouseup",(()=>{this._handleClose(window.event)})),this._popup.querySelector(".popup__close").addEventListener("click",(()=>{this.close()}))}}class u extends c{constructor(t,e){super(t),this._callbackSubmit=e,this._form=this._popup.querySelector(".popup__form"),this._inputs=[...this._form.querySelectorAll(".popup__input")]}_getInputValues(){const t={};return this._inputs.forEach((e=>{t[e.name]=e.value})),t}close(){super.close(),this._form.reset()}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(t=>{t.preventDefault(),this._callbackSubmit(this._getInputValues())}))}}function p(e){return new t(e,".element-template",(()=>v.open(e))).generateCard()}const _=new u(".popup_type_edit-profile",(function(t){d.setUserInfo(t.nameInput,t.jobInput),_.close()}));_.setEventListeners();const d=new class{constructor({title:t,subtitle:e}){this._title=document.querySelector(t),this._subtitle=document.querySelector(e)}getUserInfo(){return{title:this._title.textContent,subtitle:this._subtitle.textContent}}setUserInfo(t,e){this._title.textContent=t,this._subtitle.textContent=e}}({title:".profile__title",subtitle:".profile__subtitle"}),h=new class{constructor({renderer:t},e){this._renderer=t,this._container=document.querySelector(e)}addItem=t=>{this._container.prepend(t)};renderItems(t){t.forEach((t=>this._renderer(t)))}}({renderer:t=>h.addItem(p(t))},".elements"),m=new u(".popup_type_add-card",(t=>{h.addItem(p(t)),m.close()}));m.setEventListeners();const v=new class extends c{constructor(t){super(t),this._imagePopup=this._popup.querySelector(".popup__image"),this._imagePopupTitle=this._popup.querySelector(".popup__image-title")}open=t=>{this._imagePopupTitle.textContent=t.name,this._imagePopup.alt=t.name,this._imagePopup.src=t.link,super.open()}}(".popup_type_image");v.setEventListeners();const b=new s(e,o);b.enableValidation();const f=new s(e,r);f.enableValidation(),i.addEventListener("click",(()=>(f.disableSubmitButton(),void m.open()))),n.addEventListener("click",(()=>function(){const{title:t,subtitle:e}=d.getUserInfo();l.value=t,a.value=e,b.disableSubmitButton(),_.open()}())),h.renderItems([{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}].reverse())})();